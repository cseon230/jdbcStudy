/*=====================================
 * MemberDAO.java
 * - 데이터베이스 액션 처리 전용 클래스
 =====================================*/
// Data Access Object

package com.test;

import java.sql.Connection;
import java.sql.SQLException;
import java.sql.Statement;

import com.util.DBConn_copy;

public class MemberDAO_copy
{
	// DB연결 메소드
	private Connection conn; // Conneciton 인터페이스의 conn 변수 선언. Connection 인터페이스는 특정 데이터베이스와의 연결(세션)이다
	
	
	public Connection connection() // Conneciton 인터페이스 구현
	{
		conn = DBConn_copy.getConnection();
		return conn;
	}
	
	// DB연결 종료 메소드
	public void close()
	{
		DBConn_copy.close();
	}
	
	
	// 직원 정보 입력 메소드 INSERT => executeUpdate => insert한 행의 "갯수"를 반환 => 반환값은 int 타입 
	// 직원 정보를 입력하려면 setter.. 따라서, DTO를 매개변수로 받아야 한다.
	// 이름, 주민번호, 입사일, 지역, 전화번호, 부서명, 직위명, 기본급, 수당
	public int add(MemberDTO_copy dto) throws SQLException
	{
		int result = 0;
		Statement stmt = conn.createStatement();
		String sql = String.format("INSERT INTO TBL_EMP(EMP_ID, EMP_NAME, SSN, IBSADATE"
							   + ", CITY_ID, TEL, BUSEO_ID, JIKWI_ID, BASICPAY, SUDANG)"
							   + " VALUES(EMPSEQ.NEXTVAL, '%s', '%s'"
							   + ", TO_DATE('%s', 'YYYY-MM-DD')"
							   + ", (SELECT CITY_ID FROM TBL_CITY WHERE CITY_NAME='%s')"
							   + ", '%s'"
							   + ", (SELECT BUSEO_ID FROM TBL_BUSEO WHERE BUSEO_NAME='%s')"
							   + ", (SELECT JIKWI_ID FROM TBL_JIKWI WHERE JIKWI_NAME='%s')"
							   + ", %d, %d)"
							   , dto.getEmpName(), dto.getSsn(), dto.getIbsaDate(), dto.getCityName()
							   , dto.getTel(), dto.getBuseoName(), dto.getJikwiName(), dto.getBasicPay()
							   , dto.getSudang());
		result = stmt.executeUpdate(sql); // executeUpdate는 insert,delete,update 한 레코드의 "갯수"를 반환하므로 int 형 변수에 담아야한다. 
		
		return result;
	}
}



























































































